<?xml version="1.0" encoding="UTF-8"?>

<!--
 Hive Colony Framework
 Copyright (C) 2008 Hive Solutions Lda.

 This file is part of Hive Colony Framework.

 Hive Colony Framework is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 Hive Colony Framework is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with Hive Colony Framework. If not, see <http://www.gnu.org/licenses/>.
-->

<!--
 __author__    = João Magalhães <joamag@hive.pt>
 __version__   = 1.0.0
 __revision__  = $LastChangedRevision: 72 $
 __date__      = $LastChangedDate: 2008-10-21 23:29:54 +0100 (Tue, 21 Oct 2008) $
 __copyright__ = Copyright (c) 2008 Hive Solutions Lda.
 __license__   = GNU General Public License (GPL), Version 3
-->

<build_automation xmlns="http://www.hive.pt"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.hive.pt xsd/baf.xsd">
    <artifact>
        <id>pt.hive.colony.plugins.build.automation.items.colony_integration</id>
        <version>1.0.0</version>
        <type>colony</type>
        <name>Colony Integration Build Automation Item Plugin</name>
        <description>The build automation item for the integration of the colony framework</description>
        <url>http://www.hive.pt</url>
    </artifact>
    <build>
        <default_stage>install</default_stage>
        <clean_target_directory>true</clean_target_directory>
        <plugins>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.properties</id>
                <version>1.0.0</version>
                <stage>build</stage>
                <configuration>
                    <property>
                        <key>colony_version</key>
                        <value>1.0.0-alpha</value>
                    </property>
                    <property>
                        <key>integration_base_url</key>
                        <value>http://repo.hive:8080/integration</value>
                    </property>
                    <property>
                        <key>changelog_base_url</key>
                        <value>http://trac.hive.pt:8080/changeset</value>
                    </property>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.continuous_integration</id>
                <version>1.0.0</version>
                <stage>build</stage>
                <configuration>
                    <deployment_path>$resource{system.path.integration}/colony</deployment_path>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.packing</id>
                <version>1.0.0</version>
                <stage>build</stage>
                <configuration>
                    <type>plugin</type>
                    <specification_file>$base{plugin_directory}/colony_integration_build_automation_item_plugin.json</specification_file>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.revision_control</id>
                <version>1.0.0</version>
                <stage>install</stage>
                <configuration>
                    <version_file_path>${build_automation.build.resources_directory}/version</version_file_path>
                    <changelog_file_path>${build_automation.build.resources_directory}/changelog</changelog_file_path>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony.changelog</changelog_file_path>
                    </repository>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony.plugins</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony.plugins</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony.plugins</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony.plugins.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony.plugins.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony.plugins.changelog</changelog_file_path>
                    </repository>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony.extras</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony.extras</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony.extras</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony.extras.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony.extras.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony.extras.changelog</changelog_file_path>
                    </repository>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony.language</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony.language</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony.language</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony.language.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony.language.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony.language.changelog</changelog_file_path>
                    </repository>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony.documentation</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony.documentation</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony.documentation</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony.documentation.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony.documentation.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony.documentation.changelog</changelog_file_path>
                    </repository>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony.configuration</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony.configuration</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony.configuration</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony.configuration.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony.configuration.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony.configuration.changelog</changelog_file_path>
                    </repository>
                    <repository>
                        <adapter>svn</adapter>
                        <name>pt.hive.colony_site</name>
                        <path>http://svn.hive.pt/hive-main/pt.hive.colony_site</path>
                        <target_path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony_site</target_path>
                        <version_file_path>${build_automation.build.resources_directory}/pt.hive.colony_site.version</version_file_path>
                        <previous_version_file_path>$resource{system.path.integration}/colony/LATEST_SUCCESS/resources/pt.hive.colony_site.version</previous_version_file_path>
                        <changelog_file_path>${build_automation.build.resources_directory}/pt.hive.colony_site.changelog</changelog_file_path>
                    </repository>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.template_engine</id>
                <version>1.0.0</version>
                <stage>install</stage>
                <configuration>
                    <contents>
                        <file>
                            <path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony/trunk/pt.hive.colony/src/colony/base/plugin_system_information.py</path>
                            <encoding>utf-8</encoding>
                        </file>
                        <file>
                            <path>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony/trunk/pt.hive.colony/src/scripts/all/colony_deploy.py</path>
                            <encoding>utf-8</encoding>
                        </file>
                    </contents>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.command_execution</id>
                <version>1.0.0</version>
                <stage>install</stage>
                <configuration>
                    <command>python</command>
                    <arguments>
                        <argument>$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony/trunk/pt.hive.colony/src/main.py</argument>
                        <argument>--configuration_file=config/python/configuration_integration_run.py</argument>
                        <argument>--manager_dir=$base{plugin_system_directory}/tmp/checkout/colony/pt.hive.colony/trunk/pt.hive.colony/src</argument>
                        <argument>--execution_command=pt.hive.colony.plugins.build.automation:run_automation_raise_exception pt.hive.colony.plugins.build.automation.items.colony_bundle$1.0.0$build$3%int$0%null$1%bool</argument>
                    </arguments>
                    <shell>true</shell>
                    <timeout>600</timeout>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.continuous_integration</id>
                <version>1.0.0</version>
                <stage>post-build</stage>
                <stage_dependency>install</stage_dependency>
                <configuration>
                    <deployment_path>$resource{system.path.integration}/colony</deployment_path>
                    <version_file_path>${build_automation.build.resources_directory}/version</version_file_path>
                    <zip>plugins</zip>
                    <zip>repository</zip>
                    <zip>resources</zip>
                </configuration>
            </plugin>
            <plugin>
                <id>pt.hive.colony.plugins.build.automation.extensions.email</id>
                <version>1.0.0</version>
                <stage>post-build</stage>
                <stage_dependency>install</stage_dependency>
                <configuration>
                    <receivers>
                        <receiver>
                            <name>João Magalhães</name>
                            <email>joamag@hive.pt</email>
                        </receiver>
                    </receivers>
                    <failure_receivers>
                        <receiver>
                            <name>Tiago Silva</name>
                            <email>tsilva@hive.pt</email>
                        </receiver>
                        <receiver>
                            <name>Luís Martinho</name>
                            <email>lmartinho@hive.pt</email>
                        </receiver>
                    </failure_receivers>
                </configuration>
            </plugin>
        </plugins>
    </build>
</build_automation>
